# ğŸš€ Storytelling Podcast å¿«é€Ÿé–‹å§‹æŒ‡å—

> ç›®æ¨™ï¼šæŠŠä¸€æœ¬è‹±æ–‡æ›¸çš„ç« ç¯€æª”æ¡ˆï¼ˆchapter1.txt, chapter2.txt, ...ï¼‰åœ¨å…©æ­¥é©Ÿå…§è®Šæˆã€Œå–®è²ç·šã€æ•…äº‹è¬›è§£ + èªè¨€æé»ã€çš„æ’­å®¢ç³»åˆ—ï¼Œä¸¦è‡ªå‹•åŠ å…¥å‰æƒ…å›é¡§èˆ‡ä¸‹é›†é å‘Šã€‚

---

## 1. ç’°å¢ƒèˆ‡ API

```bash
# é€²å…¥å°ˆæ¡ˆä¸¦è£å¥½ä¾è³´
cd /path/to/story telling podcast
pip install -r requirements.txt

# è¨­å®š Gemini API Key
echo "GEMINI_API_KEY=ä½ çš„_API_KEY" > .env
```

---

## 2. æº–å‚™æ›¸ç¨¿èˆ‡æ¿ƒç¸®æ‘˜è¦

1. åœ¨ `data/` åº•ä¸‹å»ºç«‹ä¸€å€‹è³‡æ–™å¤¾ï¼ˆæœ¬å°ˆæ¡ˆå·²æä¾› `data/foundation` ç¯„ä¾‹ï¼‰ã€‚
2. ä¾åºæ”¾å…¥ `chapter1.txt`, `chapter2.txt`, ...ï¼ˆæª”åå¯è‡ªè¨‚ï¼Œåªè¦èƒ½è¢« `file_pattern` åŒ¹é…ï¼‰ã€‚
3. æ¯å€‹æª”æ¡ˆå»ºè­° UTF-8 ç·¨ç¢¼ï¼Œå…§å®¹åªæ”¾è©²ç« ç¯€æ–‡å­—ã€‚
4. åŸ·è¡Œæ‘˜è¦é è™•ç†ï¼š
   ```bash
   python preprocess_chapters.py --book-id foundation
   ```
   é€™æœƒå‘¼å« Gemini-2.5-Flashï¼ŒæŠŠæ¯ç« æ¿ƒç¸®æˆç´„åŸæ–‡ 1/8 é•·åº¦çš„ recapã€‚è…³æœ¬é è¨­åŒæ™‚é€å‡ºå…¨éƒ¨è«‹æ±‚ï¼Œè‹¥æ“”å¿ƒé€Ÿç‡å¯åŠ  `--workers 5` æ§åˆ¶ä¸¦è¡Œæ•¸ï¼›è¼¸å‡ºåˆ° `book.summaries_dir`ï¼ˆé è¨­ `data/<book>/summaries`ï¼‰ã€‚è‹¥æ—¥å¾Œæ›´æ–°ç« ç¯€å…§å®¹ï¼Œå¯å†åŠ  `--force` é‡è·‘ã€‚

---

## 3. é…ç½® (podcast_config.yaml)

```yaml
basic:
  english_level: "intermediate"   # beginner / intermediate / advanced
  episode_length: "medium"        # short / medium / long
  narrator_voice: "Aoede"         # å–®è²ç·š voice
  start_chapter: 1
  chapters_per_run: 1              # æ¯æ¬¡è·‘å¹¾ç« 

book:
  chapters_dir: "./data/foundation"
  file_pattern: "chapter*.txt"      # ä¹Ÿå¯ä»¥æ˜¯ part??.md
  summaries_dir: "./data/foundation/summaries"
  encoding: "utf-8"
  min_words: 120
  clean_whitespace: true

storytelling:
  tone: ["immersive", "expressive", "warm", "curious"]
  narrative_structure:
    - Hook
    - Scene Painting
    - Conflict/Discovery
    - Language Spotlight
    - Takeaway
```

- **`english_level` å°æ‡‰æ•˜äº‹å¼·åº¦**ï¼š
  - `beginner`ï¼šæ…¢é€Ÿã€é‡è¦å­—è©å¾ŒåŠ ä¸­æ–‡æ‹¬è™Ÿã€æ¯æ®µ recapã€‚
  - `intermediate`ï¼šé©åº¦è¬›è§£ï¼Œåè®€æ›¸æœƒèªæ°£ã€‚
  - `advanced`ï¼šç´”æ•…äº‹ + æ–‡å­¸åˆ†æï¼Œç„¡ç¿»è­¯ã€‚
- **`episode_length`** æœƒè‡ªå‹•å¥—ç”¨å­—æ•¸èˆ‡ chunk åƒæ•¸ã€‚
- **`chapters_per_run`** å»ºè­° 1-3ï¼Œå¤ªå¤šæœƒè®“ä¸€è¼ªèŠ±è²»èˆ‡é¢¨éšªä¸Šå‡ã€‚

---

## 4. åŸ·è¡Œæµç¨‹

> æ­¥é©Ÿ 0ï¼šå…ˆè·‘ `python preprocess_chapters.py`ï¼›åªæœ‰åœ¨ç« ç¯€æ–‡å­—æœ‰è®Šå‹•æ™‚æ‰éœ€è¦é‡æ–°åŸ·è¡Œã€‚

### æ–¹æ³• Aï¼šå·¥ä½œæµç¨‹æ§åˆ¶å™¨
```bash
# é€æ­¥æ¨¡å¼ï¼šå…ˆçœ‹è…³æœ¬å†æ±ºå®šæ˜¯å¦ç”¢éŸ³é »
python podcast_workflow.py --mode dev

# è‡ªå‹•æ¨¡å¼ï¼šè…³æœ¬ + éŸ³é »ä¸€æ¬¡å®Œæˆ
python podcast_workflow.py --mode prod

# è‡ªè¨‚ï¼šåªè·‘è…³æœ¬æˆ–åªè·‘éŸ³é »
python podcast_workflow.py --mode custom --steps script --book-id foundation
python podcast_workflow.py --mode custom --steps audio --script-dir ./output/foundation/sessions/script_session_xxx.json
```

### æ–¹æ³• Bï¼šæ‰‹å‹•åˆ†æ­¥
```bash
python generate_script.py --book-id foundation              # ç« ç¯€è…³æœ¬
python generate_audio.py ./output/foundation/chapter3       # å–®ç« éŸ³é »
python generate_audio.py ./output/foundation/sessions/script_session_xxx.json  # æ•´æ‰¹éŸ³é »
```

---

## 5. ç”¢å‡ºä½ç½®

```
output/
â””â”€â”€ foundation/
    â”œâ”€â”€ book_metadata.json
    â”œâ”€â”€ chapters_index.json
    â”œâ”€â”€ chapter0/
    â”‚   â”œâ”€â”€ metadata.json
    â”‚   â”œâ”€â”€ podcast_script.txt
    â”‚   â”œâ”€â”€ podcast.wav (è‹¥å·²ç”¢éŸ³é »)
    â”‚   â””â”€â”€ subtitles.srt (è‹¥å·²ç”¢å­—å¹•)
    â””â”€â”€ sessions/
        â””â”€â”€ script_session_<timestamp>.json
```

`sessions/` å…§çš„ manifest æœƒåˆ—å‡ºæ‰€æœ‰ç« ç¯€ï¼Œ`generate_audio.py` åªéœ€æŒ‡å‘æ•´ä»½ JSON å³å¯ä¾åºç”¢ç”Ÿå¤šå€‹éŸ³æª”ã€‚

---

## 6. å¸¸è¦‹èª¿æ•´èˆ‡æ’éŒ¯

| å•é¡Œ | è§£æ³• |
| --- | --- |
| æ‰¾ä¸åˆ°ç« ç¯€ | ç¢ºèª `book.chapters_dir` è·¯å¾‘æ­£ç¢ºä¸”åº•ä¸‹æœ‰æª”æ¡ˆï¼ŒåŒæ™‚æª¢æŸ¥ `file_pattern` æ˜¯å¦åŒ¹é…ã€‚ |
| æ²’æœ‰æ‘˜è¦ | æª¢æŸ¥ `book.summaries_dir` æ˜¯å¦å­˜åœ¨å°æ‡‰æª”æ¡ˆï¼Œæˆ–åŸ·è¡Œ `python preprocess_chapters.py --book-id foundation --force` é‡æ–°ç”Ÿæˆã€‚ |
| è…³æœ¬æ²’å¯«åˆ°é‡é» | æª¢æŸ¥è©²ç«  TXT æ˜¯å¦å…§å®¹ä¸è¶³ï¼ˆå¯èƒ½è¢« `min_words` æ¿¾æ‰ï¼‰ï¼Œæˆ–æå‡ `episode_length`ã€‚ |
| éŸ³é »å¤±æ•— | ç¢ºèª `generate_audio.py` æŒ‡çš„ç›®éŒ„å…§æœ‰ `podcast_script.txt`ï¼›è‹¥åªæƒ³é‡è·‘å–®ç« ï¼Œç›´æ¥å‚³è©²ç« è³‡æ–™å¤¾ã€‚ |
| æƒ³æ›è²ç·š | æ”¹ `basic.narrator_voice`ï¼Œå°æ‡‰ Gemini æä¾›çš„ voice åç¨±ï¼ˆå¦‚ `Kore`, `Charon`, `Puck`ï¼‰ã€‚ |

---

## 7. æ¨è–¦å·¥ä½œæµç¨‹

1. èª¿æ•´ `start_chapter` ï¼‹ `chapters_per_run`ï¼Œåˆ†æ‰¹è¦†è“‹æ•´æœ¬æ›¸ã€‚
2. æ¯æ‰¹å…ˆæª¢æŸ¥ `chapter_xxx/metadata.json` çš„ `actual_words` èˆ‡ `level_label`ï¼Œç¢ºèªé¢¨æ ¼æ­£ç¢ºã€‚
3. ä½¿ç”¨ `python generate_audio.py <æ‰¹æ¬¡è³‡æ–™å¤¾>` ä¸€æ¬¡è¼¸å‡ºå¤šå€‹éŸ³æª”ã€‚
4. è‹¥æœ‰ç« ç¯€æƒ³é‡å¯«ï¼Œåªåˆªé™¤å°æ‡‰ç« ç¯€è³‡æ–™å¤¾ä¸¦é‡è·‘è…³æœ¬ã€‚

ç¥è£½ä½œé †åˆ©ï¼éœ€è¦é¡å¤–çš„ç« ç¯€å‘½åæˆ–è‡ªå‹•æ‘˜è¦åŠŸèƒ½æ™‚ï¼Œå†å‘Šè¨´æˆ‘ã€‚ 
